---
import { getMaxWidthClass } from '@/lib/util';
import { Image } from 'astro:assets';

type Props = {
  maxWidthContainer?: string | null;
  testimonials: {
    image: {
      src: string | undefined;
      width?: number | null | undefined;
      height?: number | null | undefined;
    };
    text?: string | null;
    name?: string | null;
    company?: string | null;
  }[];
};

let { maxWidthContainer, testimonials } = Astro.props;
---

<div
  class:list={[
    'mx-auto my-14 flex items-center justify-center',
    getMaxWidthClass(maxWidthContainer)
  ]}
>
  <div
    class='swiper-button-prev cursor-pointer p-1 text-4xl text-re-turquoise transition-colors duration-200 ease-in-out hover:text-re-blue'
  >
    <i class='fa-solid fa-chevron-left'></i>
  </div>
  <div class='swiper testimonials-slider'>
    <div class='swiper-wrapper'>
      {
        testimonials.map((testimonal, index) => () => (
          <div class='swiper-slide w-1/4 overflow-hidden'>
            <div class='flex items-center justify-between'>
              <div class='flex min-w-[425px] items-center justify-center'>
                {testimonal.image.src && (
                  <Image
                    src={testimonal.image.src}
                    alt={`Person ${index + 1}`}
                    class='h-[290px] w-[290px] rounded-full object-contain'
                    height={290}
                    width={290}
                  />
                )}
              </div>
              <div class='w-full'>
                <h1 class='mb-8 font-serif text-4xl font-bold'>
                  Kundenmeinungen
                </h1>
                <p>“{testimonal.text}“</p>
                <p class='mt-6 text-xl'>
                  <span class='mr-2 font-bold'>{testimonal.name}</span>
                  {testimonal.company}
                </p>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
  <div
    class='swiper-button-next
        cursor-pointer
        p-1
        pl-5
        text-4xl
        text-re-turquoise
        transition-colors
        duration-200
        ease-in-out
        hover:text-re-blue'
  >
    <i class='fa-solid fa-chevron-right'></i>
  </div>
</div>

<script>
  // @ts-nocheck
  import Swiper from 'swiper';
  import { Navigation } from 'swiper/modules';
  import 'swiper/css';

  for (const [index, element] of document
    .querySelectorAll('.testimonials-slider')
    .entries()) {
    new Swiper(element, {
      slidesPerView: 1,
      loop: true,
      modules: [Navigation],

      navigation: {
        nextEl: element.parentElement.querySelector('.swiper-button-next'),
        prevEl: element.parentElement.querySelector('.swiper-button-prev')
      }
    });
  }
</script>
