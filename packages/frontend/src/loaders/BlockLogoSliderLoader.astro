---
import BlockLogoSlider from '@/components/BlockLogoSlider.astro';
import { client } from '@/lib/directus';
import { readItem } from '@directus/sdk';

type Props = {
  itemId: number;
};

const { itemId } = Astro.props;

export const getBlockLogoSlider = async (itemId: number) => {
  const response = await client.request(
    readItem('block_logo_slider', itemId, {
      fields: [
        {
          slides: [{ image: ['id', 'height', 'width'] }, 'title']
        }
      ]
    })
  );

  return {
    ...response,
    slides: response.slides?.map((slide) => ({
      ...slide,
      image: {
        ...slide.image,
        src: `${import.meta.env.DIRECTUS_URL}/assets/${slide.image?.id}`
      }
    }))
  };
};
const response = await getBlockLogoSlider(itemId);
---

<BlockLogoSlider {...response} />
