---
import BlockMedia from '@/components/BlockMedia.astro';
import { client } from '@/lib/directus';
import { readItem } from '@directus/sdk';

const { itemId } = Astro.props;

export const loadBlockVideo = async (itemId: number) => {
  return await client.request(
    readItem('block_media', itemId, {
      fields: ['type', 'yt_id', { image: ['id', 'height', 'width'] }]
    })
  );
};

const response = await loadBlockVideo(itemId);

const properties = {
  type: response.type,
  ytId: response.yt_id,
  image: {
    src:
      response.image &&
      `${import.meta.env.DIRECTUS_URL}/assets/${response.image.id}`,
    width: response.image?.width,
    height: response.image?.height
  }
};
---

<BlockMedia {...properties} />
